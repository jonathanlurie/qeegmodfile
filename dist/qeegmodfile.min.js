// Build date: 2017-0719T15:12:00

/*
* Author    Jonathan Lurie - http://me.jonahanlurie.fr
* License   MIT
* Link      https://github.com/jonathanlurie/qeegmodfileparser
* Lab       MCIN - http://mcin.ca/ - Montreal Neurological Institute
*/
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[e]=c.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var e=0;return $jscomp.iteratorPrototype(function(){return e<b.length?{done:!1,value:b[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();var e=b[Symbol.iterator];return e?e.call(b):$jscomp.arrayIterator(b)};$jscomp.arrayFromIterator=function(b){for(var e,c=[];!(e=b.next()).done;)c.push(e.value);return c};$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};
$jscomp.polyfill=function(b,e,c,a){if(e){c=$jscomp.global;b=b.split(".");for(a=0;a<b.length-1;a++){var d=b[a];d in c||(c[d]={});c=c[d]}b=b[b.length-1];a=c[b];e=e(a);e!=a&&null!=e&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(b,c,a){var d=this.length||0;0>c&&(c=Math.max(0,d+c));if(null==a||a>d)a=d;a=Number(a);0>a&&(a=Math.max(0,d+a));for(c=Number(c||0);c<a;c++)this[c]=b;return this}},"es6-impl","es3");
$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(b,e){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var c=0,a={next:function(){if(c<b.length){var d=c++;return{value:e(d,b[d]),done:!1}}a.next=function(){return{done:!0,value:void 0}};return a.next()}};a[Symbol.iterator]=function(){return a};return a};$jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,c){return c})}},"es6","es3");
(function(b,e){"object"===typeof exports&&"undefined"!==typeof module?e(exports):"function"===typeof define&&define.amd?define(["exports"],e):e(b.qeegmodfile=b.qeegmodfile||{})})(this,function(b){var e=function(){this._rawData=null};e.prototype.setRawData=function(a){this._rawData=a};e.prototype.parse=function(){var a=null;try{a=this._parseNoException()}catch(d){console.warn("This file is not compatible.")}return a};e.prototype._parseNoException=function(){if(!this._rawData)return console.warn("The input buffer is null. Nothing to be parsed here."),
null;var a=this._rawData,d=new DataView(a),b,c,f,q,e,h,k;d.getUint16(0,!0);b=d.getUint8(2);b=new Uint8Array(a,3,b);b=String.fromCharCode.apply(String,b);c=d.getUint16(83,!0);f=d.getUint16(85,!0);q=d.getUint16(87,!0);e=d.getUint16(89,!0);h=d.getUint16(91,!0);k=d.getUint16(93,!0);for(var l=c*f*q*e,m=l*k,r=new Float32Array(l),g=0;g<l;g++)r[g]=d.getFloat32(95+g*k,!0);h=95+m+h;k=d.getUint8(h);k=new Uint8Array(a,h+1,k);String.fromCharCode.apply(String,k);k=h+9;h=Array(8);for(g=0;8>g;g++)l={total:d.getUint16(k+
6*g+4,!0),labels:null},h[g]=l;h[0].description="list of labels for measure dimension";h[1].description="list of labels for duration dimension";h[2].description="list of labels for first space dimension";h[3].description="list of labels for second space dimension";h[4].description="list of scales";h[5].description="list of units";h[6].description="list of transformations";h[7].description="list of contexts";k+=48;for(g=0;g<h.length-2;g++){m=h[g].total;h[g].labels=m?Array(m).fill(""):0;for(var p=0;p<
m;p++){if(l=d.getUint8(k)){var n=new Uint8Array(a,k+1,l),n=String.fromCharCode.apply(String,[].concat($jscomp.arrayFromIterable(n)));h[g].labels[p]=n.replace("\u00e6","\u00b5").replace("\u00fd","\u00b2")}k+=l+1}}g=d.getUint8(k);h[6].labels=g;k+=h[6].total*(g+1);g=h[h.length-1];g.contextsByteLength=Array(g.total);g.types=Array(g.total);g.values=Array(g.total);p=/[a-zA-Z ]*\:{1}([a-zA-Z]*)[\[]?\d*[\]]?/;g.labels=Array(g.total).fill("");for(m=0;m<g.total;m++)l=d.getUint8(k),n=new Uint8Array(a,k+1,l),
n=String.fromCharCode.apply(String,n),g.labels[m]=n.split(":")[0],g.contextsByteLength[m]=d.getUint16(k+l+1,!0),n=p.exec(n),g.types[m]=n?n[1].toLowerCase():null,k+=l+3;for(m=0;m<g.total;m++){l=null;if("single"===g.types[m])l=d.getFloat32(k,!0);else if("boolean"===g.types[m])for(l=Array(g.contextsByteLength[m]),n=0;n<l.length;n++)l[n]=!!d.getUint8(k+n);else"string"===g.types[m]&&(l=d.getUint8(k),n=new Uint8Array(a,k+1,l),l=String.fromCharCode.apply(String,n));k+=g.contextsByteLength[m];g.values[m]=
l}for(g=0;g<h.length;g++)delete h[g].total;delete h[7].contextsByteLength;delete h[7].types;return{metadata:{comment:b,sizes:{measure:c,duration:f,firstSpace:q,secondSpace:e},informationList:h},data:r}};var c=function(a){this._typeCode=this._qeegModObj=null;this._typeCodeMap={"Z Electrical Tomography for Cortex and Basal Ganglia":"ZETCBG","Z Electrical Tomography for Cortex":"ZETC","Z Cross Spectrum":"ZCROSS","Z Broad Band":"ZBBSP",Phase:"PHA","Electrical Tomography for Cortex and Basal Ganglia":"ETCBG",
"Electrical Tomography for Cortex":"ETC","Cross Spectrum":"CROSS",Correlation:"COR",Coherence:"COH","Broad Band":"BBSP"};this.setQeegModObj(void 0===a?null:a)};c.prototype._defineTypeCode=function(){var a=this.getType();a in this._typeCodeMap&&(this._typeCode=this._typeCodeMap[a])};c.prototype.setQeegModObj=function(a){if(a=void 0===a?null:a)this._qeegModObj=a,this._defineTypeCode()};c.prototype.getType=function(){return this._qeegModObj.metadata.comment};c.prototype.getTypeCode=function(){return this._typeCode};
c.prototype.getMeasureLabels=function(){return this._qeegModObj.metadata.informationList[0].labels};c.prototype.getDurationsLabels=function(){return this._qeegModObj.metadata.informationList[1].labels};c.prototype.getFirstSpacelabels=function(){return this._qeegModObj.metadata.informationList[2].labels};c.prototype.getSecondSpacelabels=function(){return this._qeegModObj.metadata.informationList[3].labels};c.prototype.getUnitsLabels=function(){return this._qeegModObj.metadata.informationList[5].labels};
c.prototype.getMeasureSize=function(){return this._qeegModObj.metadata.sizes.measure};c.prototype.getDurationSize=function(){return this._qeegModObj.metadata.sizes.duration};c.prototype.getFirstSpaceSize=function(){return this._qeegModObj.metadata.sizes.firstSpace};c.prototype.getSecondSpaceSize=function(){return this._qeegModObj.metadata.sizes.secondSpace};c.prototype.getDimensionSizes=function(){return[this._qeegModObj.metadata.sizes.measure,this._qeegModObj.metadata.sizes.duration,this._qeegModObj.metadata.sizes.firstSpace,
this._qeegModObj.metadata.sizes.secondSpace]};c.prototype.getNumberOfDimensionsUsed=function(){for(var a=this.getDimensionSizes(),d=a.length-1;0<=d;d--)if(1<a[d])return d+1;return 0};c.prototype.getTranformation=function(){return this._qeegModObj.metadata.informationList[6].labels};c.prototype.getContext=function(a){return 0>a||a>=this._qeegModObj.metadata.informationList[7].labels.length?(console.warn("The context index is out of range"),null):{label:this._qeegModObj.metadata.informationList[7].labels[a],
value:this._qeegModObj.metadata.informationList[7].values[a]}};c.prototype.getAllContexts=function(){var a=this._qeegModObj.metadata.informationList[7];if(a.labels.length!=a.values.length)return console.warn("The contexts is corrupted. Inequal amount of values/labels."),null;for(var d=[],b=0;b<a.labels.length;b++)d.push({label:a.labels[b],value:a.values[b]});return d};c.prototype.getStartFrequency=function(){return this._qeegModObj.metadata.informationList[7][0].value};c.prototype.getFrequencyResolution=
function(){return this._qeegModObj.metadata.informationList[7][1].value};c.prototype.getScaleFactor=function(){return this._qeegModObj.metadata.informationList[7][2].value};c.prototype.getScaleIfScaleMeasures=function(){return this._qeegModObj.metadata.informationList[7][3].value};c.prototype.getMeasureLabel=function(){return this._qeegModObj.metadata.informationList[7][4].value};c.prototype.getDurationLabel=function(){return this._qeegModObj.metadata.informationList[7][5].value};c.prototype.getFirstSpaceLabel=
function(){return this._qeegModObj.metadata.informationList[7][6].value};c.prototype.getSecondSpaceLabel=function(){return this._qeegModObj.metadata.informationList[7][7].value};c.prototype.getSecondSpaceLabel=function(){return this._qeegModObj.metadata.informationList[7][7].value};c.prototype.getValue=function(a,d,b,c){var f=this._qeegModObj.metadata.sizes;if(0>a||a>=f.measure)return console.warn("measureIndex is out of range."),null;if(0>d||d>=f.duration)return console.warn("durationIndex is out of range."),
null;if(0>b||b>=f.firstSpace)return console.warn("firstSpaceIndex is out of range."),null;if(0>c||c>=f.secondSpace)return console.warn("secondSpaceIndex is out of range."),null;a=this._getOffset(a,d,b,c);return this._qeegModObj.data[a]};c.prototype.getSpectrum=function(a,d,b){a=void 0===a?-1:a;d=void 0===d?-1:d;b=void 0===b?-1:b;var c=this._qeegModObj.metadata.sizes,f=this._qeegModObj.data;return-1==a&&-1==d&&-1==b?f.slice():0<=a&&a<c.measure&&-1==d&&-1==b?(c=this._getOffset(a,0,0,0),a=this._getOffset(a+
1,0,0,0),f.slice(c,a)):0<=a&&a<c.measure&&0<=d&&d<c.duration&&-1==b?(c=this._getOffset(a,d,0,0),a=this._getOffset(a,d+1,0,0),f.slice(c,a)):0<=a&&a<c.measure&&0<=d&&d<c.duration&&0<=b&&b<c.firstSpace?(c=this._getOffset(a,d,b,0),a=this._getOffset(a,d,b+1,0),f.slice(c,a)):null};c.prototype.getSpectrumByLabels=function(a,d,b){a=void 0===a?null:a;d=void 0===d?null:d;b=void 0===b?null:b;var c=this._qeegModObj.metadata.informationList,f=c[0].labels.indexOf(a),e=c[1].labels.indexOf(d),c=c[2].labels.indexOf(b);
return a&&-1==f?(console.warn("The measure label "+a+" could not be found."),null):d&&-1==e?(console.warn("The duration label "+d+" could not be found."),null):b&&-1==c?(console.warn("The first-space label "+b+" could not be found."),null):this.getSpectrum(f,e,c)};c.prototype.getSpectrumLabelsByLabels=function(a,b,c){a=void 0===a?null:a;b=void 0===b?null:b;c=void 0===c?null:c;var d=this._qeegModObj.metadata.informationList,f=d[0].labels.indexOf(a),e=d[1].labels.indexOf(b),d=d[2].labels.indexOf(c);
return a&&-1==f?(console.warn("The measure label "+a+" could not be found."),null):b&&-1==e?(console.warn("The duration label "+b+" could not be found."),null):c&&-1==d?(console.warn("The first-space label "+c+" could not be found."),null):this.getSpectrumLabels(f,e,d)};c.prototype.getSpectrumLabels=function(a,b,c){a=void 0===a?-1:a;b=void 0===b?-1:b;c=void 0===c?-1:c;var d=this._qeegModObj.metadata.sizes,f=this._qeegModObj.metadata.informationList,e=[];return-1==a&&-1==b&&-1==c?(f[0].labels&&e.push(f[0].labels.slice()),
f[1].labels&&e.push(f[1].labels.slice()),f[2].labels&&e.push(f[2].labels.slice()),f[3].labels&&e.push(f[3].labels.slice()),e):0<=a&&a<d.measure&&-1==b&&-1==c?(this._getOffset(a,0,0,0),this._getOffset(a+1,0,0,0),f[0].labels&&f[0].labels.length>a&&e.push(f[0].labels[a]),f[1].labels&&e.push(f[1].labels.slice()),f[2].labels&&e.push(f[2].labels.slice()),f[3].labels&&e.push(f[3].labels.slice()),e):0<=a&&a<d.measure&&0<=b&&b<d.duration&&-1==c?(this._getOffset(a,b,0,0),this._getOffset(a,b+1,0,0),f[0].labels&&
f[0].labels.length>a&&e.push(f[0].labels[a]),f[1].labels&&f[1].labels.length>b&&e.push(f[1].labels[b]),f[2].labels&&e.push(f[2].labels.slice()),f[3].labels&&e.push(f[3].labels.slice()),e):0<=a&&a<d.measure&&0<=b&&b<d.duration&&0<=c&&c<d.firstSpace?(this._getOffset(a,b,c,0),this._getOffset(a,b,c+1,0),f[0].labels&&f[0].labels.length>a&&e.push(f[0].labels[a]),f[1].labels&&f[1].labels.length>b&&e.push(f[1].labels[b]),f[2].labels&&f[2].labels.length>c&&e.push(f[2].labels[c]),f[3].labels&&e.push(f[3].labels.slice()),
e):null};c.prototype._getOffset=function(a,b,c,e){var d=this._qeegModObj.metadata.sizes;return(a*d.duration*d.firstSpace+b*d.firstSpace+c)*d.secondSpace+e};b.QeegModFileParser=e;b.QeegModFileInterpreter=c;Object.defineProperty(b,"__esModule",{value:!0})});
